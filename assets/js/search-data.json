{
  
    
        "post0": {
            "title": "Introduction",
            "content": "The ultimate weapon in the arsenal of a historian just might be a time machine. While historians can infer a lot from written texts and archaeological digs, no substitute could best being in the past and observing. Unfortunately for historians, a time machine has yet to be invented. Astronomers, however, are more fortunate in this field. . In September 1905 Albert Einstein published his famous paper &quot;On the Electrodynamics of moving Bodies&quot;[1] in which he posed the theory of special relativity. While it was known from electromagnetism that the speed of light is a constant, it wasn&#39;t understood how light travels at the same speed regardless of which direction light was fired in. What Einstein discovered was almost analogous to the geocentric model of the solar system of old: whichever way you look out to in the cosmos, you&#39;re looking into the past. . Since light is a wave traveling through the expanding universe, it undergoes Doppler shift and therefore cosmological objects that move away from the observer undergo a shift in the frequency of light. This is known as redshift, because the expanding wavelength means that visible light would shift towards the red end of the spectrum. Just 12 years after Einstein&#39;s discovery, American Astronomer Vesto Slipher [2] discovered the redshift of distant galaxies and with it cosmological spectroscopy was born. . . A part of the light spectrum. Visible light is expanded to show the different colors. Note how red light in the visible spectrum has a longer wavelength, giving redshift its name. Image taken from [3] . Combine cosmological redshift and special relativity and we get a sort of astronomical time machine: looking far out into the cosmos means we are looking into the past where the universe was much younger. However, just pointing a telescope at the night sky poses a few problems. . Cosmological formation . Understanding how stars and galaxies form out of a uniformly gaseous universe is one of the biggest areas of research in modern physical cosmology. The physical processes by which these happen might be well understood, but the amount of possible initial values of these processes are so vast that they can have wildly different outcomes[4]. Looking at these events occurring in the distant past (and therefore distant universe) is therefore an important instruments astronomers have. . Unfortunately, the formation of these cosmological bodies happen inside thick dust clouds which are opaque to visible light and are therefore investigated using what is called sub-millimeter astronomy: astronomy ranging from $200 : mathrm{ mu m}$ to about $1 : mathrm{mm}$. In frequency terms, following . $$ begin{equation} f = frac{c}{ lambda} end{equation}$$this corresponds with about $300 : mathrm{GHz}$ to $1500 : mathrm{GHz}$. . The Messer-16 nebula, dubbed &quot;The Eagle&quot;, captured by the Hubble Space Telescope is an example of a dust cloud that is opaque to visible light. Image taken from [5] . Redshift . As mentioned before, the redshift of light gives us the opportunity to calculate the relative speed and therefore distance and age of astronomical sources. When I talk about redshift, I mean the following formal definition [6] . $$ begin{equation} 1+z = frac{f_ mathrm{emit}}{f_ mathrm{obs}} end{equation}$$where $z$ denotes redshift and $f_ mathrm{emit}$ and $f_ mathrm{obs}$ denote the emitted and observed frequency of a signal respectively. In order to calculate redshift we therefore need to know both frequencies. . Emitted frequency . Quantum mechanics tells us that the electron configuration in atoms exist in quantized states. That is to say: they can move between defined states, but not in the continuum inbetween. When an atom moves from one configuration to a higher state energy is absorbed, when it moves to a lower state energy is emitted. These quantized energy states give way to what is known as spectral lines, where a specific wavelength is known to be emitted by specific atoms. . A few energy states of carbon. Note how higher energy gaps result in shorter wavelengths. Image taken from [7] . This becomes clear when we look at the spectral flux density $E_{e, nu}$ of a galaxy, simulated with the Python module galspec[8]. . The spectral flux density of a simulated galaxy with different redshifts. . Beside broad spectrum thermal noise the galaxy emits spectral peaks. From the figure it is clear that with higher $z$ the peaks move further to the left, towards lower frequencies and therefore higher wavelengths. If one were to look for peaks in incoming signal and measure the wavelength at which these peaks occur, the redshift and thus age of a galaxy can be detected. . Observed frequency . In order to know the wavelength of these spectral lines at our detection point, we need to measure the specific frequency of an incoming photon in a spectrometer. This can be done using a Coherent Heterodyne receiver, except that these devices work to a frequency of about $36 : mathrm{Ghz}$[9], much lower than the spectral lines we are interested in as shown above. . Traditional photon detectors, at their core, work by converting an incoming photon into an electrical current, which means that the specific momentum, energy or frequency of the photon is lost. A way around this is to move the incoming photons depending on their wavelength, such as happens in an optical prism. . When a photon enters the prism, its angle changes depending on its wavelength. Image taken from [10] . This is how a lot of spectrometers work, but due to the large wavelengths and high redshift range $(1+z approx1-10)$[11] of the signals involved in galaxy spectroscopy this approach is not feasible. . DESHIMA . DESHIMA, short for the Deep Spectroscopic High-Redshift Mapper, is a spectrometer developed by a team at the TU Delft that takes another approach[11][12]. DESHIMA uses a series of bandpass filters on a supercooled chip to direct incoming photons into bins, where they are detected by photomultipliers. The advantage of this approach is that the spectrometer itself is really small, taking up just a few squared centimeters and is easily scalable to multiple octaves[11]. . A schematic overview of the DESHIMA 2.0 chip. Image taken from [13] . DESHIMA is placed on ASTE, a ground-based sub-millimeter telescope near the ALMA site in the Atacama Desert. . A panoramic shot from the ASTE site in the Atacama Desert. Image taken from [14] . Ground-based astronomy . While the ASTE site is high up in the Atacama desert, the telescope still needs to look through some atmosphere when doing observations. Since cosmological object of interest are often far away and very cold, they are much dimmer than the effects from the atmosphere. The atmosphere is almost completely opaque at some frequencies DESHIMA operates in and this loads the antenna dish because it is much hotter and therefore brighter than the astronomical source. . Below the atmospheric loading at the ASTE site is calculated by the software package deshima-sensitivity[15] and plotted with a galaxy spectrum synthesized by galspec: . Comparing atmospheric loading to astronomical source loading. The former is over 3 orders of magnitude brighter. . The atmosphere is over 3 orders of magnitude brighter than the galaxy spectrum before the latter is attenuated. After the atmospheric attenuation the difference is even bigger. Therefore modeling the expected loading from the atmosphere and the entire chain from antenna to detector is important to be able to do measurements and to find the signal within the noise. deshima-sensitivity[15] was designed to do this, but takes some approximations that were deemed too reductive. . This Project . The current version of deshima-sensitivity does not take filter profiles into consideration when calculating the power received on each channel. It samples the power spectral density calculated to be at the filter&#39;s center frequency and multiplies this with the filter bandwidth, creating a crude box filter. While this approach holds for flat power spectra, it doesn&#39;t quite hold for spectra like the one above. . In this project I will modify the existing deshima-sensitivity package to more accurately resemble the DESHIMA 2.0 filter profiles and therefore the spectrometer as a whole. In order to do so, I will first need to dive into the DESHIMA system in more depth and then give a brief but thorough overview of photon statistics and the associated photon noise. Finally I will model the system and compare it with previous versions of deshima-sensitivity. . Next Chapter Bibliography . [1]A. Einstein, “Zur Elektrodynamik bewegter Körper,” Annalen der Physik, vol. 322, no. 10, pp. 891–921, 1905, doi: 10.1002/andp.19053221004. | [2]V. M. Slipher, “Radial velocity observations of spiral nebulae,” The Observatory, vol. 40, pp. 304–306, 1917, doi: 10.1002/andp.19053221004. | [3]A. Lemke, “The visible light spectrum,” Once Inc. Aug-2020 [Online]. Available at: https://www.once.lighting/visible-light-spectrum/ | [4]A. Blain, “Submillimeter galaxies,” Physics Reports, vol. 369, no. 2, pp. 111–176, Jan. 2002, doi: 10.1016/s0370-1573(02)00134-5. | [5]R. Garner, “Messier 16 (The Eagle Nebula),” NASA. NASA, Oct-2017 [Online]. Available at: https://www.nasa.gov/feature/goddard/2017/messier-16-the-eagle-nebula | [6]A. Endo, “Session 2 | Line Emission and Cosmological Redshift ,” EE3350TU Introduction to Radio Astronomy. Nov-2020. | [7]R. Nave, “Carbon Energy Levels,” hyperphysics.phy. [Online]. Available at: http://hyperphysics.phy-astr.gsu.edu/hbase/Atomic/carbon.html | [8]T. Bakx and S. Brackenhoff, “galspec v0.2.6,” pypi.org. Open Source, Nov-2020 [Online]. Available at: https://pypi.org/project/opensimplex/ | [9]A. J. Baker, From z-machines to ALMA: (sub)millimeter spectroscopy of galaxies: proceedings of a workshop held at the North American ALMA Science Center of the National Radio Astronomy Observatory in Charlottesville, Virginia, United States, 12-14 January 2006. Astronomical Soc. of the Pacific, 2007, p. 375. | [10]E. Optics, “Introduction to Optical Prisms,” Edmund Optics. [Online]. Available at: https://www.edmundoptics.eu/knowledge-center/application-notes/optics/introduction-to-optical-prisms/ | [11]A. Endo et al., “First light demonstration of the integrated superconducting spectrometer,” Nature Astronomy, vol. 3, no. 11, pp. 989–996, 2019, doi: 10.1038/s41550-019-0850-8. | [12]A. Endo et al., “Wideband on-chip terahertz spectrometer based on a superconducting filterbank,” Journal of Astronomical Telescopes, Instruments, and Systems, vol. 5, no. 03, p. 1, 2019, doi: 10.1117/1.jatis.5.3.035004. | [13]E. et al. Huijten, “TiEMPO: Open-source time-dependent end-to-end model for simulating ground-based submillimeter astronomical observations,” Millimeter, Submillimeter, and Far-Infrared Detectors and Instrumentation for Astronomy X, 2020, doi: 10.1117/12.2561014. | [14]D. R. Jacobsen, “Atacama Submillimeter Telescope Experiment complex, Chile.” English Wikipedia, 06-Jul-2008 [Online]. Available at: https://commons.wikimedia.org/w/index.php?curid=60009729 | [15]A. Endo and A. Taniguchi, “deshima-sensitivity v0.3.0,” pypi.org. Open Source, Jun-2021 [Online]. Available at: https://pypi.org/project/deshima-sensitivity/ | .",
            "url": "https://joristiebosch.github.io/thesis/introduction",
            "relUrl": "/introduction",
            "date": " • Jan 7, 2022"
        }
        
    
  
    
        ,"post1": {
            "title": "DESHIMA",
            "content": "In 2017, as part of the first light campaign, the first DESHIMA device was proven to work as expected when mounted to the ASTE telescope[1], but was limited in scope. The chip had just 49 channels and a spectral resolution of $ nu/ Delta nu approx380$, with a spectral range of $327 : mathrm{GHz}$ to $377 : mathrm{GHz}$. This proof of concept led to the development of DESHIMA 2.0 and the Science Verification Campaign[2]. With 347 channels in the range of $220 : mathrm{GHz}$ to $440 : mathrm{GHz}$ and a spectral resolution of $ nu/ Delta nu approx500$, DESHIMA 2.0 is much more capable. Besides the obvious bandwidth and channel upgrades, the sensitivity has also been increased four to eight fold [3]. In this thesis I will be discussing DESHIMA 2.0, but it is entirely applicable to any DESHIMA-type spectrometer. . The 49 filter channels and their transmission as measured from the original DESHIMA. Image taken from [1] . The 347 filter channels and their transmission as measured on DESHIMA 2.0. Image taken from [2] . The Optical Chain . As mentioned, DESHIMA is installed on the ASTE radio-telescope in the Atacama desert. This means that the light from distant galaxies travels through the atmosphere towards the dish of the telescope, where it gets reflected to the secondary mirror. The set of primary and secondary mirror is called a Cassegrain reflector and focuses the signal. . A schematic drawing of a Cassegrain reflector. Image taken from [4] . After the incoming signal has been focused, it passes a set of mirrors in the telescope cabin and then passes through a window into the cryostat. At a temperature of $4 : mathrm{K}$ the light passes through a low-pass filter, a third set of mirrors and a polarizer, until reaching the spectrometer chip at a temperature of $120 : mathrm{mK}$. . The optical chain of the DESHIMA spectrometer. After passing through the Cassegrain reflector, the light hits an ellipsoidal mirror (EM), a hyperbolic mirror (HM), a low-pass filter (LPF), two parabolic mirrors (PM), a wire grid polarizer (WG) a low pass and band pass filter (LPF, BPF) until it hits the spectrometer. Image taken from [1] . Every optical component has a corresponding efficiency $ eta_ mathrm{opt}$ and reflects only a part of the incoming signal while also adding to that signal, in a process called a radiative transfer[5]: . $$ begin{equation} mathrm{PSD_{out}}= eta_ mathrm{opt} mathrm{PSD_{in}} + left(1- eta_ mathrm{opt} right) mathrm{PSD_{opt}} end{equation}$$Here $ mathrm{PSD}$ is the power spectral density, which for the emission of the optical component is given by Johnson-Nyquist[6]: . $$ begin{equation} mathrm{PSD} left( nu,T right)= frac{h nu}{e^{h nu/k_BT}-1} end{equation}$$which depends on both temperature and frequency. Therefore the radiative transfer of the optical chain needs to be calculated across the frequency spectrum for every component at its temperature. This means that the total optical chain is a series of radiative transfers. For a simple two mirror system this is the following $$ begin{equation} mathrm{PSD_{in}} rightarrow mathrm{M1} rightarrow mathrm{PSD_{intermediate}} rightarrow mathrm{M2} rightarrow mathrm{PSD_{out}} end{equation}$$ . To simplify the calculations, efficiencies of components at the same temperature can be taken together . $$ begin{equation} begin{split} mathrm{PSD_{out}}&amp;= eta_2 mathrm{PSD_{intermediate}} + left(1- eta_2 right) mathrm{PSD_{opt}} &amp;= eta_2 left( eta_1 mathrm{PSD_{in}} + left(1- eta_ mathrm{opt} right) mathrm{PSD_{opt}} right) + left(1- eta_ mathrm{2} right) mathrm{PSD_{opt}} &amp;= eta_1 eta_2 mathrm{PSD_{in}}+ eta_2 left(1- eta_1 right) mathrm{PSD_{opt}}+ left(1- eta_2 right) mathrm{PSD_{opt}} &amp;= eta_1 eta_2 mathrm{PSD_{in}}+ eta_2 mathrm{PSD_{opt}}- eta_1 eta_2 mathrm{PSD_{opt}}- eta_2 mathrm{PSD_{opt}}+ mathrm{PSD_{opt}} &amp;= eta_1 eta2 mathrm{PSD_{in}} + left(1- eta_1 eta2 right) mathrm{PSD_{opt}} end{split} end{equation}$$At ASTE, the atmosphere is around $273 : mathrm{K}$ and the cabin is $290 : mathrm{K}$. as mentioned before the cold optics and the chip are $4 : mathrm{K}$ and $120 : mathrm{mK}$ respectively. If we plot the $ mathrm{PSD_{opt}}$ for the different components along with the power a galaxy transmits to a telescope dish with a diameter of $10 : mathrm{m}$, we get the following figure: . Besides the loading at the chip level, the optical components are much brighter than the astronomical source. . As is clear from the figure, the efficiency of all but the cold optics really matter in the range DESHIMA measures in, which is why they need to be modeled carefully in deshima-sensitivity. . The Detector . DESHIMA detects photons using (Microwave) Kinetic Inductance Detectors, or (M)KID for short. These work by exploiting the energy gap in superconducting materials. . Inside the superconducting material electrons are coupled together in cooper-pairs at energy levels $E_F$. When these pairs get excited, the electrons move as quasiparticles to a higher energy level $E ge E_F+ Delta_{AL}$ [7], where $ Delta_{AL}=188 : mathrm{MeV}$ the gap energy of an aluminium superconductor[5]. . Therefore, if an incoming photon carries enough energy to excite a pair of these electrons, specifically more than $2 Delta_{Al}$, it increases the number of quasiparticles. This means that the photon needs . $$ begin{equation} E=h nu gt2 Delta_{Al} iff nu gt frac{2 Delta_{Al}}{h} approx 91 : mathrm{GHz} end{equation}$$which is perfect for the $220 : mathrm{GHz}$ to $440 : mathrm{GHz}$ range we are interested in. . . When an incident photon has enough energy to overcome the energy gap, the cooper pair breaks and generates quasiparticles. Image taken from [7] . Resonance Circuit . The cooper pairs decrease the inductance[8], so when these are broken the overall inductance increases. In order to measure this change in inductance, the detector is designed as parallel sets of RLC circuits, designed such that the total frequency of the resonance is in the range of $4-6 : mathrm{GHz}$[2]. . . RLC circuits are used to read the change in inductance. Parallel RLC circuits divide the frequency to a range that the read-out electronics can handle. Image taken from [7] . These circuits are resonant when the reactance of the inductor and the capacitor are equal: . $$ begin{equation} X_L=X_C iff omega L = frac{1}{ omega C} iff omega_r= frac{1}{ sqrt{LC}} end{equation}$$and therefore the resonance gets lowered by a decrease in cooper pairs. . In order to read out the detector, a signal at the resonant frequency is fed into the superconductor. When the resonant frequency decreases, so does the transmission and therefore an increase in power is measured[7]. . . The change in resonance frequency lowers the transmission, therefore increasing the power. This increase in power is measured. Image taken from [7] . Previous Chapter Next Chapter Bibliography . [1]A. Endo et al., “First light demonstration of the integrated superconducting spectrometer,” Nature Astronomy, vol. 3, no. 11, pp. 989–996, 2019, doi: 10.1038/s41550-019-0850-8. | [2]A. Taniguchi et al., “DESHIMA 2.0: development of an integrated superconducting spectrometer for science-grade astronomical observations.” 2021. | [3]M. Rybak et al., “DESHIMA 2.0: Rapid redshift surveys and multi-line spectroscopy of dusty galaxies.” 2021. | [4]H. Hahn, “Diagram Reflector Cassegrain.” Wikimedia, 01-Apr-2010 [Online]. Available at: https://nl.m.wikipedia.org/wiki/Bestand:Diagram_Reflector_Cassegrain.svg | [5]A. Endo and A. Taniguchi, “deshima-sensitivity v0.3.0,” pypi.org. Open Source, Jun-2021 [Online]. Available at: https://pypi.org/project/deshima-sensitivity/ | [6]A. Endo, “Session 4 | Photon Noise,” EE3350TU Introduction to Radio Astronomy. Dec-2020. | [7]J. Baselmans, “Kinetic inductance detectors,” Journal of Low Temperature Physics, vol. 167, no. 3-4, pp. 292–304, 2012, doi: 10.1007/s10909-011-0448-8. | [8]R. Meservey and P. M. Tedrow, “Measurements of the Kinetic Inductance of Superconducting Linear Structures,” Journal of Applied Physics, vol. 40, no. 5, pp. 2028–2034, 1969, doi: 10.1063/1.1657905. | .",
            "url": "https://joristiebosch.github.io/thesis/deshima",
            "relUrl": "/deshima",
            "date": " • Jan 6, 2022"
        }
        
    
  
    
        ,"post2": {
            "title": "Photon Statistics",
            "content": "Because of the inherent probability quantum mechanics entails, photons arriving at some detector follow statistical properties. In this chapter I will discuss these Photon Statistics and the unintuitive way photons behave when they arrive sparsely. . Photon Noise . In order to calculate the noise, we need to know the power that is impinging on the detector due to atmospheric loading. However, do take into account that when looking at an astronomical object far away, the detector is measuring photons that this galaxy randomly emits. This means that in the context of radio astronomy our signal is also photon noise[1]! Therefore when I discuss noise in this chapter I both mean actual noise as is used in our signal to noise calculations and photon noise that is received as signal. . Photon noise can be split up into two categories: thermal noise and shot noise. In this section I will take a look at both . Thermal Noise . In radio receivers, a big part of the noise is generated by thermal agitation of electrons. In most uses this can be classified as white noise: the power is constant across its frequency spectrum [2], but in extremely high frequencies or low temperatures this approximation doesn&#39;t hold. The power $P$ transmitted by the noise is given as Johnson-Nyquist Noise and is approximated for small bandwidths $ Delta nu$ as[3]: . $$ begin{equation} P_ nu= int_{ nu_0}^{ nu_1} frac{h nu}{e^{h nu/k_BT}-1}d nu approx frac{h nu}{e^{h nu/k_BT}-1} Delta nu end{equation}$$Plotting this normalized ($P_ nu/k_BT$) power spectrum supports my earlier statements that, in most cases, thermal noise can be approximated as white . Comparing the normalized Johnson-Nyquist noise for different temperatures shows that it is white for low frequencies . Unfortunately, this white noise approximation doesn&#39;t hold for the DESHIMA range. Once more, it is also not the only form of noise we have to deal with. . Shot noise . When the source is very dim, photons arrive one at a time. This means that we are dealing with shot noise[1]. Here the detection rate of a photon is characterized by Poisson statistics and the famous Poisson distribution [4]: . $$ begin{equation} f(x)= frac{ lambda^xe^{- lambda}}{x!} end{equation}$$Hence we also call this noise Poisson noise. . Typical Poisson curves for different parameters. . Uncertainty . From Poisson statistics we know that the uncertainty $ sigma_N$ over a number of measurements is equal to the square root of these measurements, since it&#39;s an uncorrelated process [4][1]. Because our power arrives with single photons hitting the detector, the power follows the same uncertainty . $$ begin{equation} sigma_N= sqrt{N} end{equation}$$$$ begin{equation} sigma_P propto sqrt{P} end{equation}$$However, if we look at Johnson-Nyquist noise and approximate for lower frequencies we get[1][3]: . $$ begin{equation} P approx frac{h nu}{e^{h nu/k_BT}-1} Delta nu approx k_BT Delta nu end{equation}$$$$ begin{equation} sigma_P propto P end{equation}$$Hence we have found two proportionality relations for the uncertainty, which is it? . Particle-Wave duality . The seemingly paradoxical nature of this uncertainty can be explained as a caveat of the particle-wave duality. In the wave domain the Johnson-Nyquist noise dominates, whereas in the particle domain we get mainly Poisson noise. The general case of the uncertainty in the number of photons arriving in a detection time of $ tau$ is[5][6]: . $$ begin{equation} sigma_ mathrm{ph}= frac{1}{ sqrt{ tau}} sqrt{n^2+n} end{equation}$$with $n$, the photon number, being the number of photons per time per bandwidth. Here both extremes are more obvious: for $n gg 1$ we get the thermal noise from the wave domain and for $n ll 1$ the Poisson uncertainty falls out. . An analogy for the detection of photons in the particle and wave limit. Image taken from [1] . The photon number for a thermal blackbody radiator is given by the Bose-Einstein equation [7][6] . $$ begin{equation} n_ mathrm{th} left( nu,T right)= frac{1}{e^{h nu/k_BT}-1} end{equation}$$Which means that in the region between $220 :{ mathrm{GHz}}$ and $440 :{ mathrm{GHz}}$ for a relatively hot object the photon occupation number is neither fully in the wave limit nor the particle limit. . The photon number for different temperatures is neither fully in the wave limit nor fully in the particle limit in the DESHIMA range . Finally, another mechanism for noise needs discussing. Mainly in the wave domain, where the photon number is higher, photons tend to come clumped together in a process known as photon bunching[6]. . Photon Bunching . Quantum Electrodynamics has taught us that photons behave stochastically, so it is reasonable to assume that photon detection also occurs randomly. While this is (obviously) true to some degree, in the previous section I stated photons can arrive &#39;clumped&#39; together at the detector in a phenomenon known as photon bunching. This means that detecting one photon will result in a higher chance of another photon being detected within a specified time, called the coherence time $t_{ mathrm{coh}}$ [6]. In this chapter I will first present an intuitive, qualitative explanation as to why photon bunching occurs. Then I will go deeper into the mathematics and quantum mechanics of photon bunching and the specific case of the DESHIMA system. . An analogy . To understand photon bunching, first think of photons arriving at the detector like raindrops falling on a piece of paper. While it&#39;s raining with constant intensity, the chance of a raindrop falling on a specific area within, say, the next second (expressed by $P( mathrm{drop})$) is constant. In the figure below I have set $P( mathrm{drop}) = 0.3$: . Plotting occurrences and the underlying probability for a constant chance. . The raindrops fall uncorrelated: every second a new chance of $P( mathrm{drop})$ means a raindrop falling from the sky might land in our defined area. This is how unbunched, or random, photons behave. . Now let&#39;s assume the chance of a raindrop occurring is not constant over time, but rather varies relatively slowly over time. This could be because of varying wind speeds or varying intensity in the rain, but whatever the case the rain drops are no longer uncorrelated. There are moments of high intensity, where the chance of a raindrop is high and similarly there are moments of low intensity. I have simulated this using open simplex noise [8] in the following graph. . Plotting occurrences and the underlying probability for a varying chance. . As is clear from the graph, the raindrops are clumped together. This is the same underlying principle as photon bunching in photons from astronomical sources. The random motion of the exciting atoms, for example Brownian motion, means that the intensity also fluctuates over time[6]. It is therefore not the act of detecting a photon that increases the chance of another detection, but rather an underlying change in probability of detecting, easily explained by probabilistics. . This means that at the point where a raindrop falls or a photon gets emitted, it is still a simple stochastic process. Should our sampling interval be much smaller than the time over which the rain varies, we&#39;d still see &#39;stochastic regions&#39;, where the probability function stays roughly constant, like in the first example. This is illustrated in the graph below with stretched noise: . Plotting occurrences and the underlying probability for a slowly varying chance. . The droplets appear less bunched, because the time scale in which the measurements take place is much smaller than the time scale in which the intensity changes. The very first example I spoke about, of raindrops falling at a constant intensity, is a situation in which this discrepancy occurs. Of course it won&#39;t rain forever and when the rain dies down the chance of a raindrop falling is much lower than while it&#39;s still raining. So while the droplets look purely random when it rains, they aren&#39;t over the course of the entire day. I will call this behavior bunched (slow timescale), because the sampling time is much faster than the coherence time, which I shall later elaborate on further. . Let&#39;s also take a look at what happens when the sampling time is much slower than the underlying probability fluctuations. . Plotting occurrences and the underlying probability for a quickly varying chance. . As expected, the detection rate looks much like the first detection rate with constant $P left( mathrm{drop} right)$. Although the underlying probability changes, it changes too fast between detections for bunching to occur. . Intermezzo: Antibunching . While this report focuses on photon bunching, the opposite also occurs in, for example, single photon sources [9]. Now that I have discussed a framework with which to explain photon bunching, I thought it would be remiss to leave out an explanation for antibunching. . As one would expect, in antibunching the opposite of bunching happens: detecting a raindrop would mean that, at least for the next period of time, the chance of a raindrop falling becomes smaller. A good allegory for this is a dripping faucet. A small flow of water exits the faucet and, due to surface tension, pools up in a small droplet at the end. As the droplet gets bigger, the chance of it falling increases, but once it drips down it takes all water with it and the process starts anew. . An analogy for anti-bunching. . This behavior corresponds with antibunching behavior in single photon sources[9]. Atoms are excited through an energy pump process. When this energy increases sufficiently they emit a photon and lose energy, ready to get excited again[6]. . Again, the detection of such single photons will display antibunching, but it is not the detection that triggers this cool-down period, it is the emission. . All different probability and occurrences for the discussed probabilities. These are toggleable By selecting modes in the legend. . Coherence . If the underlying probability function is unknown (and quantum mechanically it is), how would we be able to quantify whether our detections are bunched. A possible heuristic we can use comes from signal processing. We could take the autocorrelation of the signals and compare them. Since the autocorrelation is the cross-correlation between the signal and a time-shifted copy, we&#39;d likely see the bunched signal display some sort of correlation for a delay that is around the timescale of the oscillations in the probability function. In the figure below I have correlated the detections described above with $t in[0,1000]$ and plotted these values for different time delays $h$ . The autocorrelation for the different photon modes. . As is clear from the graph, the bunched photons show some autocorrelation, with the longer timescale showing longer (bigger time shifts) autocorrelation. This can be explained further by signal analysis. We are working in the discrete domain and smaller sampling steps relative to the variation in the underlying probability will mean more correlation. . What this shows is temporal coherence, a property of light that describes the predictability over a timescale[1]. . Bandwidth . Up until now we have only looked at raindrops as analogous detections, but when talking about photons we need to take frequency into account. Photons obey the Heisenberg uncertainty relation where the uncertainty in position $ Delta x$ and momentum $ Delta p_x$ must obey [1]: . $$ begin{equation} Delta x Delta p_x = frac{ hbar}{2} end{equation}$$Our photons are flying at the detector, so it&#39;s uncertainty in longitudinal ($z$, towards the detector) position can be equated as it&#39;s uncertainty in detection time and it&#39;s momentum can be expressed as $h/ lambda$: . $$ begin{equation} Delta z Delta p_z= frac{ Delta t}{c} frac{h}{ Delta lambda} = frac{ Delta t}{c} frac{hc}{ Delta nu} = frac{ hbar}{2} end{equation}$$and finally we arrive at . $$ begin{equation} Delta nu propto frac{1}{ Delta t} end{equation}$$In other words: a shorter coherence time means more accurate knowledge on where the photons are, meaning their uncertainty in momentum and therefore bandwidth is bigger. . This relation can also be seen experimentally. In Morgan and Mandel&#39;s 1966 paper[10], the authors explore the autocorrelation between two different light sources: a Hg198 source with a very narrow bandwidth (a) and a tungsten light bulb with a broad spectrum thermal source (b). By designing an apparatus that counts the number of times two photon arrive within a defined time period, they show the autocorrelation of the two light sources . The number of times per second two photons arrived after a specified time delay for a a) Hg198 light source and a b) tungsten incandescent light source. Image taken from [10] . Because the tungsten light has a high bandwidth, it has a short coherence time and the reverse is true for the Hg198 light. Therefore, if we take the short timescale bunched photons as an analogy for the tungsten light and the longer timescale bunched lights as analogous for the mercury light, we get something that looks very similar. . The autocorrelation of just the slow and short bunched timescale photons behave like the spectral and tungsten source respectively. . With a more thorough understanding of photon bunching, it is time to return to photon noise and discuss noise-equivalent power. . Noise Equivalent power . The noise equivalent power ($ mathrm{NEP}$) is a way to express the sensitivity of a photon detectors. It is defined as the input signal power that results in a signal-to-noise-ratio of 1 in a 1 Hz output bandwidth. [11]. For our purposes this means multiplying the photon noise with the photon energy[12]. From [7] we have an equation for the electrical (detected) photon noise . $$ begin{equation} sigma_ mathrm{ph}^2= frac{1}{ tau} int_0^ infty eta( nu)n( nu) left[1+ eta( nu)n( nu) right]d nu end{equation}$$multiplying this integral with the photon energy, we get the electrical Noise Equivalent Power added by photon noise for a specified integration time . $$ begin{equation} mathrm{NEP}_{ tau, mathrm{ph}}^2= frac{1}{ tau} int_0^ infty left(h nu right)^2 eta( nu)n( nu) left[1+ eta( nu)n( nu) right]d nu end{equation}$$But unfortunately this integral is not easily solvable. As we&#39;ve seen in the previous section, the coherence time is inversely proportional to the bandwidth and by taking an integral we effectively have an infinitesimal bandwidth and therefore an infinite coherence time. . If we were to create a perfect box filter, and approximate the photon number as constant over this filter we can get around this. Let&#39;s first define this box function . $$ begin{equation} Pi^{ Delta nu}_{ nu_0}( nu)= left { begin{array}{ll} 1 &amp; | nu- nu_0| le frac{ Delta nu}{2} 0 &amp; mathrm{elsewhere} end{array} right. end{equation}$$And then set $ eta( nu)= eta_0 Pi^{ Delta nu}_{ nu_0}( nu)$. When we assume we have a constant photon occupation number over this range, the equation simplifies to: . $$ begin{equation} begin{split} mathrm{NEP}_{ tau, mathrm{ph}}^2&amp;= frac{1}{ tau} int_0^ infty left(h nu right)^2 eta_0 Pi^{ Delta nu}_{ nu_0}( nu)n( nu) left[1+ eta_0 Pi^{ Delta nu}_{ nu_0}( nu)n( nu) right]d nu &amp;= frac{1}{ tau} int_{ nu_0- frac{ Delta nu}{2}}^{ nu_0+ frac{ Delta nu}{2}} left(h nu right)^2 eta_0n left[1+ eta_0n right]d nu end{split} end{equation}$$Which, for $ Delta nu ll nu$ approximates as: $$ begin{equation} mathrm{NEP}_{ tau, mathrm{ph}}^2= frac{1}{ tau} left(h nu_0 right)^2 eta_0n left[1+ eta_0n right] Delta nu end{equation}$$ . In astrophysics it is convention to take an integration time of $ tau=0.5 : mathrm{[s]}$ which results in a Noise Equivalent Power of: . $$ begin{equation} mathrm{NEP}_{ tau=0.5 mathrm{s}, mathrm{ph}}=h nu_0 sqrt{2 eta_0n left(1+ eta_0n right) Delta nu} end{equation}$$ DESHIMA . In actual measurements the photon occupation number isn&#39;t known, but we are able to deduce it from the power spectral density, as per Bose-Einstein statistics[6]: . $$ begin{equation} n_ mathrm{ph}= frac{ mathrm{PSD}}{h nu} end{equation}$$Inserting this in the equation for $ mathrm{NEP}$ we get: . $$ begin{equation} mathrm{NEP}_{ tau=0.5 mathrm{s}, mathrm{ph}}= sqrt{2 eta_0 mathrm{PSD}h nu_0 left(1+ eta_0 mathrm{PSD} right) Delta nu} end{equation}$$If we assume the $ mathrm{PSD}$ to be flat, for a box filter the power spectrum multiplied by the bandwidth multiplied by the efficiency is obviously the power on the detector. . $$ begin{equation} P_ mathrm{KID}= eta_0 mathrm{PSD} Delta nu_0 end{equation}$$rearranging we get: . $$ begin{equation} mathrm{NEP}_{ tau=0.5 mathrm{s}, mathrm{ph}}= sqrt{2P_ mathrm{KID}h nu_0 + 2 frac{P^2_ mathrm{KID}}{ Delta nu}} end{equation}$$Which is in agreement with [13]. . Generation-Recombination Noise . Besides photon noise (both Poisson and bunching), another type of noise adds to our $ mathrm{NEP}$: recombination noise. This is a type of noise that occurs in superconductor-based pair-breaking photon detectors. As mentioned before, incoming photons generate quasiparticles in the detector, which later recombine in a cooper pair [14]. For our purposes we will take the noise equivalent power of recombination noise $ mathrm{NEP_R}$ as given by [13]: . $$ begin{equation} mathrm{NEP_{R}}= sqrt{4 Delta_ mathrm{Al} frac{P_ mathrm{KID}}{ eta_ mathrm{pb}}} end{equation}$$Even though the amount of quasiparticles generated is proportional to the incoming power, the recombination noise happens randomly and is therefore an uncorrelated process. This means we can add the $ mathrm{NEP_R}$ and $ mathrm{NEP_{ph}}$ together by quadrature addition, creating a total noise equivalent power given by: . $$ begin{equation} mathrm{NEP}_{ tau=0.5 mathrm{s}} = sqrt{ mathrm{NEP}_{ tau=0.5 mathrm{s}, mathrm{ph}}^2 + mathrm{NEP_{R}}^2} end{equation}$$$$ begin{equation} mathrm{NEP}_{ tau=0.5 mathrm{s}}= sqrt{2P_ mathrm{KID}h nu_0 + 2 frac{P_ mathrm{KID}^2}{ Delta nu}+4 Delta_ mathrm{Al} frac{P_ mathrm{KID}}{ eta_ mathrm{pb}}} end{equation}$$Finally, quasiparticles also generate randomly without any incoming photons, eg when the detector is kept in total darkness[15]. This is called Generation-Recombination noise and is negligible compared to the photon noise and photon-induced recombination noise as can be seen in the figure below: . The noise induced by spontaneous Generation and recombination of quasiparticles is negligible compared to photon noise. Image taken from [15] . Because this difference is negligible, I therefore won&#39;t model it. . Previous Chapter Next Chapter Bibliography . [1]G. B. Taylor, C. L. Carilli, and R. A. Perley, Synthesis imaging in radio astronomy II: a collection of lectures from the Sixth NRAO/NMIMT Synthesis Imaging Summer School held at Socorro, New Mexico, USA, 17-23 June 1998. Astronomical Society of the Pacific, 2008, pp. 671–688. | [2]C. S. Turner, “Johnson Nyquist noise - clay’s DSP Page,” Johnson-Nyquist Noise. Wireless Systems Engineering, Inc., Jan-2007 [Online]. Available at: http://www.claysturner.com/dsp/Johnson-Nyquist%20Noise.pdf | [3]A. Endo, “Session 4 | Photon Noise,” EE3350TU Introduction to Radio Astronomy. Dec-2020. | [4]F. M. Dekking, C. Kraaikamp, L. H.P, and L. E. Meester, A modern introduction to probability and statistics: Understanding why and how. Springer-Verlag, 2011. | [5]A. Endo, “Memo: Poisson limit and bunching limit of photon NEP: Deshima Kibela,” Memo: Poisson limit and Bunching limit of Photon NEP. Kibela, Nov-2020 [Online]. Available at: https://deshima.kibe.la/shared/entries/96349e15-acfa-474f-adf8-f21ebe25cda5 | [6]H. Paul, Introduction to quantum optics: from light quanta to quantum teleportation. Cambridge University Press, 2004, pp. 127–153. | [7]J. Zmuidzinas, “Thermal noise and correlations in photon detection,” Applied Optics, vol. 42, no. 25, p. 4989, 2003, doi: 10.1364/ao.42.004989. | [8]K. Spencer and O. S. Community, “opensimplex v0.3,” pypi.org. Open Source, Dec-2021 [Online]. Available at: https://pypi.org/project/opensimplex/ | [9]M. Krottenmüller, “Photon Statistics,” Technische Universität München. May-2013 [Online]. Available at: https://www.mpq.mpg.de/5020834/0508a_photon_statistics.pdf | [10]B. L. Morgan and L. Mandel, “Measurement of Photon Bunching in a Thermal Light Beam,” Physical Review Letters, vol. 16, no. 22, pp. 1012–1015, 1966, doi: 10.1103/physrevlett.16.1012. | [11]P. L. Richards, “Bolometers for infrared and millimeter waves,” Journal of Applied Physics, vol. 76, no. 1, pp. 1–24, 1994, doi: 10.1063/1.357128. | [12]S. Leclercq, “Discussion about Noise Equivalent Power and its use for photon noise calculation,” 2007 [Online]. Available at: https://www.iram.fr/ leclercq/Reports/About_NEP_photon_noise.pdf | [13]A. Endo et al., “First light demonstration of the integrated superconducting spectrometer,” Nature Astronomy, vol. 3, no. 11, pp. 989–996, 2019, doi: 10.1038/s41550-019-0850-8. | [14]P. J. de Visser, “Quasiparticle dynamics in aluminium superconducting microwave resonators,” Mar. 2014, doi: 10.4233/uuid:eae4c9fc-f90d-4c12-a878-8428ee4adb4c. | [15]P. J. D. Visser, J. J. A. Baselmans, J. Bueno, N. Llombart, and T. M. Klapwijk, “Fluctuations in the electron system of a superconductor exposed to a photon flux,” Nature Communications, vol. 5, no. 1, 2014, doi: 10.1038/ncomms4130. | .",
            "url": "https://joristiebosch.github.io/thesis/photon-statistics",
            "relUrl": "/photon-statistics",
            "date": " • Jan 5, 2022"
        }
        
    
  
    
        ,"post3": {
            "title": "The Model",
            "content": "The original deshima-sensitivity code follows the following flowchart . . The optical chain described in the flowchart consists of serial transmission calculations from 1 medium to another. This entire chain of stacked transformations of the spectral input power can be regarded as a single affine transformation of the input and is independent of the bandwith or amount of frequency bins. It will remain unchanged throughout the proposed modifications. . The power impinging on a detector for a specific filter bin is calculated by taking the spectral flux density at the center frequency $ nu_c$ and multiplying this with the bandwith $ Delta nu$. This matches the model of the previous described box filter, assuming the flux density $ mathrm{psd}$ is flat over the entire bandwith. This is not the case however, as we shall see. . Filter distribution . 1 filter channel has so far been approximated as a box integral, which isn&#39;t physically possible and therefore inaccurate. The actual filter shapes are described by a Lorentzian curve . $$ begin{equation} eta left( nu right)= frac{A gamma^2}{ left( nu- nu_0 right)^2+ gamma^2} end{equation}$$Where $ gamma$ is the half-width at half maximum (HWHM) value, for DESHIMA given as $$ begin{equation} gamma= frac{ nu_c}{2R} end{equation}$$ with $R=500$ the spectral resolution. As we have seen previously our box filters were defined by an efficiency constant labeled $ eta_0$. Together with the bandwidth, this describes the transmission of the box filter. If we define the full width at half maximum for the Lorentzian as the bandwidth of the Lorentzian, we would like to define the $A$ parameter such that the area of this $ mathrm{FWHM}$ is exactly the same as the area of the box filter. . The different sections of the Lorentzian filter. The box approximation and the in-band part of the Lorentzian have the same area. . $$ begin{equation} int_{ nu_0- gamma}^{ nu_0+ gamma} frac{A gamma^2}{ left( nu- nu_0 right)^2+ gamma^2}d nu= frac{ pi}{2} gamma A Leftrightarrow A = frac{4}{ pi} eta_0 end{equation}$$Meaning our filters are given by . $$ begin{equation} eta left( nu right)= frac{4}{ pi} frac{ eta_0 gamma^2}{ left( nu- nu_0 right)^2+ gamma^2} end{equation}$$For atmospheric loading, which as you might recall is the main source of the noise, the channel is of course loaded over the entire filter spectrum: both in and out band. Luckily this is as simple as widening the effective bandwidth with a constant: . $$ begin{equation} int_{- infty}^{ infty} frac{A gamma^2}{ left( nu- nu_0 right)^2+ gamma^2}d nu= pi gamma A=2 int_{ nu_0- gamma}^{ nu_0+ gamma} frac{A gamma^2}{ left( nu- nu_0 right)^2+ gamma^2}d nu end{equation}$$Meaning that the full band effective bandwidth is exactly twice the in band effective bandwidth. . Noise Equivalent Power . Redoing the calculation of the noise equivalent power for a flat $ mathrm{PSD}$, but with proper Lorentzian filters this time, results in: . $$ begin{equation} begin{split} mathrm{NEP}_{ tau=0.5 mathrm{s}, mathrm{ph}}^2&amp;=2 int_0^ infty h nu eta( nu) mathrm{PSD}+ eta^2( nu) mathrm{PSD}^2d nu &amp;=2 mathrm{PSD} int_0^ infty h nu eta( nu)d nu+2 mathrm{PSD}^2 int_0^ infty eta^2( nu)d nu &amp; approx8 mathrm{PSD}h nu_0 eta_0 gamma + frac{16}{ pi} mathrm{PSD}^2 eta_0^2 gamma &amp;=4 mathrm{PSD}h nu_0 eta_0 mathrm{FWHM}+ frac{8}{ pi} mathrm{PSD}^2 eta_0^2 mathrm{FWHM} end{split} end{equation}$$where an approximation is used for the first term, assuming $ Delta nu ll nu$. Because the calculations are done for a constant $ mathrm{PSD}$, the filter gets loaded across the full band, meaning the effective bandwidth $ Delta nu=2 mathrm{FWHM}$. Putting this in the equation for the $ mathrm{NEP}_{ tau=0.5 mathrm{s}, mathrm{ph}}$ yields: . $$ begin{equation} begin{split} mathrm{NEP}_{ tau=0.5 mathrm{s}, mathrm{ph}} &amp;= 2 mathrm{PSD} eta_0 Delta nu+ frac{4}{ pi} mathrm{PSD}^2 eta_0^2 Delta nu &amp;=2P_ mathrm{KID}h nu_0 + frac{4}{ pi} frac{P^2_ mathrm{KID}}{ Delta nu} end{split} end{equation}$$Which means the second term, the bunching term, is a factor of $ pi/2$ smaller than is the case for narrow-bandwidth approximation described in [1] and used in [2]. . Non-flat Power Spectrum Densities . We know the $ mathrm{NEP}$ is proportional to the $ mathrm{PSD}$ impinging on the detector, and we have also seen that the atmospheric loading is a much bigger contribution to the spectral flux density than any atmospheric source. let&#39;s take a look at how this atmospheric loading varies over the bin width. In the figures below the actual target frequency channels from DESHIMA 2.0 are taken and compared to the atmospheric model measured at ASTE, taken from deshima-sensitivity. . A non-flat power spectral density overlayed over box filters. The out of band loading is not calculated. . For the channels where the atmospheric loading is reasonably constant over the bandwidth this approximation is fine, however when the spectral flux density peaks to twice it&#39;s local background level the box filters are obviously a poor approximation for reality. The atmospheric loading is averaged over the bandwidth before being multiplied with it in the current version of deshima-sensitivity, in essence integrating it over the box filter. However, this crude approximation clearly fails when looking at the actual Lorentzian filters. . A non flat power spectral density overlayed over Lorentzian filters. Here filters are loaded out of band. . The peak at $286.1 : mathrm{GHz}$ is obviously loading channel 131 and 132, but due to the wide profile of a Lorentzian even 130 and 133 are receiving energy from the peak in flux density. . The total power impinged on the detector can be approximated by calculating the spectral power arriving at the detector not just at the center frequencies of the bins $ nu_0$, but by expanding the number of frequencies calculated to some amount of integration bins and calculating the spectral power at these frequencies. For an integration frequency $ nu_i$ and a channel $j$, the effective power loading by that frequency on that channel is given by: . $$ begin{equation} P_{ mathrm{KID},i,j} = eta left( nu_i,j right) mathrm{psd} left( nu_i right) Delta nu_i label{p_kid_i} end{equation}$$with $ Delta nu_i$ the bandwidth for that frequency. The total power impinged on a filter channel $P_{ mathrm{KID},j}$ is then given by: . $$ begin{equation} P_{ mathrm{KID},j}= sum_i P_{ mathrm{KID},i,j} = sum_i eta left( nu_i,j right) mathrm{psd} left( nu_i right) Delta nu_i label{p_kid} end{equation}$$To make this more visual, take a look at the figure below . A stem plot of the power spectral density overlayed over binned Lorentzian filters. . The calculated flux spectrum arriving at the filter will be calculated as is done in the current version of the deshima-sensitivity package, but using a finer frequency resolution. This spectrum will then arrive at the filter, where for each channel a weighted sum will be taken over all integration bins, resulting in a total power impinged on the detector. . Noise Equivalent Power . As seen, the photon noise equivalent power for a single DESHIMA channel $ mathrm{NEP}_{ tau=0.5 mathrm{s}, mathrm{ph},j}$is given by[1]: . $$ begin{equation} mathrm{NEP}_{ tau=0.5 mathrm{s}, mathrm{ph},j}^2=2 int_0^ infty h nu eta( nu) mathrm{PSD}+ eta^2( nu) mathrm{PSD}^2d nu end{equation}$$Again taking the filter efficiency $ eta left( nu_i,j right)$ and $ mathrm{PSD}$ constant over a single integration frequency, and multiplying $ mathrm{PSD}$ with the bandwidth to get the power impinged by an integration bin on the channel $P_{ mathrm{KID},i}$ we can easily take the Riemann sum of this integral as . $$ begin{equation} mathrm{NEP}_{ tau=0.5 mathrm{s}, mathrm{ph},j}^2=2 sum_i left( h nu_iP_{ mathrm{KID},i}+ frac{P_{ mathrm{KID},i}^2}{ Delta nu_i} right) label{nep_ph} end{equation}$$The recombination noise $ mathrm{NEP_{R}}$ is given by . $$ begin{equation} mathrm{NEP}_{ mathrm{R},j}^2=4 Delta_ mathrm{Al} frac{P_{ mathrm{KID},j}}{ eta_ mathrm{pb}}=4 Delta_ mathrm{Al} frac{ sum_i{P_{ mathrm{KID},j,i}}}{ eta_ mathrm{pb}} end{equation}$$Which results in a total $ mathrm{NEP}_{ tau=0.5 mathrm{s}}$ of . $$ begin{equation} mathrm{NEP}_{ tau=0.5 mathrm{s}} = sqrt{2 sum_i left( h nu_iP_{ mathrm{KID},i}+ frac{P_{ mathrm{KID},i}^2}{ Delta nu_i} right) + 4 Delta_ mathrm{Al} frac{ sum_i{P_{ mathrm{KID},j,i}}}{ eta_ mathrm{pb}}} label{total_NEP} end{equation}$$ Photon Bunching . But what about photon bunching? I have shown that the coherence time and the bandwidth are inversely proportional. By decreasing the size of the integration bins we have also decreased the bandwidth and therefore increased the coherence time. Thankfully the integration time of our definition of the noise equivalent power, $0.5 : mathrm{s}$, is orders of magnitude bigger than the coherence time [3]. As we have seen earlier, if the photons are sampled at orders of magnitude higher than the coherence time, doubling the coherence time (halving the bandwith) has no effect. You might say we are hiding the non-stochastic effects of photon bunching in the coarseness of our Riemann sum. . Now the $ mathrm{NEP}$ is simply defined at $ tau=0.5 : mathrm{s}$, but in measurements the integration time can vary. The $ mathrm{NEP}$ is scaled accordingly: . $$ begin{equation} begin{split} mathrm{NEP}_{ tau} &amp;= frac{1}{ sqrt{ tau}} sqrt{ sum_i left( h nu_iP_{ mathrm{KID},i}+ frac{P_{ mathrm{KID},i}^2}{ Delta nu_i} right) + 2 Delta_ mathrm{Al} frac{ sum_i{P_{ mathrm{KID},j,i}}}{ eta_ mathrm{pb}}} &amp;= frac{1}{ sqrt{2 tau}} mathrm{NEP}_{ tau=0.5 mathrm{s}} end{split} end{equation}$$But this scaling doesn&#39;t hold indefinitely. I conjecture that at some point the incoming photons are sampled at such a short sampling interval that they become correlated, as we have seen previously. This comes with a drop in noise as in the limit either zero or one photon can arrive. This is shown qualitatively in the figure below. . A conjectured noise equivalent power scaling with decreasing integration times . The Filter Matrix . From eq eqref{p_kid_i} we can see that we need a two dimensional function $ eta left( nu_i,j right)$ to go from a one dimensional $ mathrm{PSD}$ to a power spectrum for each filter channel. We do this programmatically by calculating a matrix that takes in a vector containing the $ mathrm{PSD}$ at each integration frequency and uses that to calculate the power loading by this $ mathrm{PSD}$ on each channel. . Shown in the figure below is a visualization of how this filter matrix might look like. . A visual interpretation of the filter matrix. Only 20 channels are shown. . With this framework in place it is easy to swap out the generated filter with another, more realistic model of the filters. The figure below shows a simulated filter transmission curve for the DESHIMA 2.0 chip. . A simulated filter profile of the DESHIMA 2.0 spectrometer . As you can see, the filters aren&#39;t all equally efficient and wide. In the figure below all 346 bins and the corresponding values of $R$ are plotted, with the size corresponding to the transmission. . The variations of this simulated filter are clear in this plot. The size corresponds to the transmission. Hover over and the χ2 parameter of the fit is shown for each channel. . While using a perfect Lorentzian approximation for the filter profiles for each channel is better than the center frequency sampling that is done now, it might be more advantageous to be able to use simulated or measured profiles. The filter matrix will therefore, depending on the users choice, be either generated via Lorentzian curves or loaded in via a file. . Transforming the calculated noise . Once the $ mathrm{NEP}$ has been calculated, it needs to be transformed back into something more usable to define the sensitivity of the instrument. We do this by calculating the source coupling through a quantity named the Noise Equivalent Source Flux $ mathrm{NEF}$. The $ mathrm{NEF}$ is defined as the amount of power a source needs to emit per second to equal the $ mathrm{NEP}$ in strength and is therefore our sensitivity: a source with a flux lower than the $ mathrm{NEF}$ will be hidden in the noise of the measurement data. Take note that the $ mathrm{NEF}$ is defined for an integration time of $ tau=1 : mathrm{s}$, rather than $ tau=0.5 : mathrm{s}$ as is the case for the $ mathrm{NEP}$. The $ mathrm{NEF}$ is given by: $$ begin{equation} mathrm{NEF} = frac{ mathrm{NESP}_{ tau=0.5 mathrm{s}}}{ sqrt{2}A_g}= frac{ mathrm{NEP_{inst,{ tau=0.5 mathrm{s}}}}}{ eta_ mathrm{sw} sqrt{2}A_g}= frac{ mathrm{NEP}_{ tau=0.5 mathrm{s}}}{ eta_ mathrm{inst} eta_ mathrm{sw} sqrt{2}A_g} end{equation}$$ . with $A_g$ the area of the telescope, $ eta_ mathrm{sw}$ the aggregate efficiency from the source to the window of the cryostat chamber DESHIMA is housed in and $ eta_ mathrm{inst}$ the instrument efficiency. The first two remain unchanged throughout the modifications discussed in this chapter, however $ eta_ mathrm{inst}$ is dependent on $ eta_ mathrm{filter}$ and is therefore modified. . Since the calculation of the $ mathrm{NEP}_{ tau=0.5 mathrm{s}}$ as in eqref{total_NEP} collapses the noise equivalent power down to a single value per channel, we can&#39;t use the efficiency as calculated for the integration bins to go back through the system in order to calculate the source coupling. Instead there are two different approximations we can take to calculate the source coupling: an in-band and a full band approximation . In-band Source Coupling . The in-band approximation is used for spectral sources. A spectral source is defined as an object that transmits only within the bandwidth of a single filter channel, where we define the bandwidth as the $ mathrm{FWHM}$ . A spectral source is defined as a source that fully fits within the bandwidth of a channel. Shown here for a Lorentzian filter . In order to get a single value of an efficiency, let&#39;s say $ eta_ mathrm{inst}$, over the full in-band bandwidth, I take a weighted average over the $ mathrm{FWHM}$ where the weights are given by the filter. . $$ begin{equation} eta_ mathrm{inst,j}= frac{ int_{ nu_j- gamma}^{ nu_j+ gamma} eta_ mathrm{inst} left( nu right) eta_ mathrm{filter} left( nu,j right)d nu}{ int_{ nu_j- gamma}^{ nu_j+ gamma} eta_ mathrm{filter} left( nu,j right)d nu} end{equation}$$This ensures that the efficiency per channel is normalized such that I can use the box-filter approximation on our way back through the system. . Because spectral sources fit within the bandwidth of a single channel, the box-approximation holds very well. . Full-band Source Coupling . Besides spectral sources, astronomical objects also radiate a continuous spectrum, through blackbody radiation: . The continuum of blackbody radiation loads the entire channel. Because it varies so slowly over the channel, it can be assumed as constant over a channel and the box filter approximation holds too. . Because this continuum source is as near as makes no difference constant over the frequency bin, we can model it&#39;s transmission by another box-filter, with double the bandwidth of the spectral case, as I have derived previously. . In this case, the efficiencies are calculated using another weighted average, weighted over the full band this time . $$ begin{equation} eta_ mathrm{inst,j}= frac{ int_0^ infty eta_ mathrm{inst} left( nu right) eta_ mathrm{filter} left( nu,j right)d nu}{ int_0^ infty eta_ mathrm{filter} left( nu,j right)d nu} end{equation}$$The Final Model . Using these two approximations, the NEP can be transformed back through the system and to the sky again. This means that the total model looks like this: . Previous Chapter Next Chapter Bibliography . [1]J. Zmuidzinas, “Thermal noise and correlations in photon detection,” Applied Optics, vol. 42, no. 25, p. 4989, 2003, doi: 10.1364/ao.42.004989. | [2]A. Endo et al., “First light demonstration of the integrated superconducting spectrometer,” Nature Astronomy, vol. 3, no. 11, pp. 989–996, 2019, doi: 10.1038/s41550-019-0850-8. | [3]B. L. Morgan and L. Mandel, “Measurement of Photon Bunching in a Thermal Light Beam,” Physical Review Letters, vol. 16, no. 22, pp. 1012–1015, 1966, doi: 10.1103/physrevlett.16.1012. | .",
            "url": "https://joristiebosch.github.io/thesis/the-model",
            "relUrl": "/the-model",
            "date": " • Jan 4, 2022"
        }
        
    
  
    
        ,"post4": {
            "title": "Results",
            "content": "To verify the changes made to the model, let&#39;s compare it to the old model. . Impinged Power . The new model calculates the $P_ mathrm{KID}$ of the $j$th channel as a Riemann sum approximation of . $$ begin{equation} P_{ mathrm{KID},j} = int_0^ infty mathrm{PSD_{filter}} left( nu right) eta left(j, nu right)d nu end{equation}$$whereas the old model approximated this integral as a square filter with width $ Delta nu= mathrm{FWHM}$. Therefore the new model takes in a much wider range of the $ mathrm{PSD}$ and is thus expected to be higher in local minima and lower in local maxima of the $ mathrm{PSD}$. . The old and new power per channel, overlayed over the Power spectral density. The simulated filters are hidden by default. . The figure above behaves exactly as expected. . Noise Equivalent Power . The $ mathrm{NEP}$ is calculated using the Riemann sum of the following integral . $$ begin{equation} mathrm{NEP}_{ tau=0.5 mathrm{s},j}=2 int_0^ infty h nu eta left( nu,j right) mathrm{PSD} + eta left( nu,j right)^2 mathrm{PSD}^2 + frac{4 Delta_ mathrm{Al}}{ eta_ mathrm{pb}} eta left( nu,j right) mathrm{PSD}d nu end{equation}$$where the three separate terms are the Poisson term, the bunching term and the recombination term respectively. Plotting this integral yields the following result: . The old and new Noise Equivalent Power per channel, overlayed over the Power spectral density. The simulated filters are hidden by default. . As we can see, and as is expected, the new model has a lower $ mathrm{NEP}$. Plotting the three separate terms, we get the following: . The three terms of the NEP plotted. Toggle in the legend to compare different terms. . As is clear from the figure, the terms behave as expected, with the new model &#39;smoothing&#39; over the local extrema in the Poisson and recombination term, but leaving them otherwise unchanged. The bunching term is however smaller in the new model. . The Bunching Term . As we have seen the old approximation overestimated the bunching term by a factor of $ pi/2$. For a constant $ mathrm{PSD}$ The bunching term is given by . $$ begin{equation} mathrm{NEP}_{ tau=0.5 mathrm{s},j, mathrm{bunching}}= frac{8}{ pi} mathrm{PSD}^2 eta_0^2 mathrm{FWHM} end{equation}$$Whereas the old model this was given by . $$ begin{equation} mathrm{NEP}_{ tau=0.5 mathrm{s},j, mathrm{bunching}}=4 mathrm{PSD}^2 eta_0^2 mathrm{FWHM} end{equation}$$We can verify this in the following figure, where I have divided the old model by the new model. From our calculations, this should be on average $ pi/2$ . The ratio between the old and new bunching terms. A constant line of half π is plotted as indication. . Simulated filterbank . In order to compare the simulated filterbank to the new and old models, it is more advantageous to look at the $ mathrm{NEP_{inst}}$. Recall that the $ mathrm{NEP_{inst}}$ is the $ mathrm{NEP}$ divided by the total instrument efficiency: comparing an &#39;unnormalized&#39; $ mathrm{NEP}$ is deceiving, since a lower noise equivalent power does not necessarily mean a lower signal to noise ratio. . The instrument NEP of the old, new and newly simulated filters. . Since the ideal filter model is generated with parameters which are the target for DESHIMA, the simulated filters behave almost without exception worse than the perfect Lorentzian filters. The outliers have very low transmissions, meaning that in order to improve the sensitivity the transmission needs to increase. . Noise Equivalent Flux Density . As described in the previous chapter, another modification to the model is the calculation of the $ mathrm{NEFD}$, both for a spectral and a continuum source, with the latter being twice the former. . Let&#39;s take a look at $ mathrm{NEFD_{cont}}$ first. . The Continuum Case . The different Noise Equivalent Flux Density for the continuum case. . Because of the limited sampling range of the old model, the value of $ eta_ mathrm{sw}$ is (very close to) zero for channels where the atmospheric transmission is very close to zero. Because the new model takes the wide filters into account, this effect is lowered somewhat, since these channels are still loaded through the fringes of the Lorentzian when the atmosphere is opaque in the center. . The different atmospheric transmissions over the full filter band. . The Spectral Case . For the spectral case this difference is resolved, as spectral sources by definition don&#39;t load the fringes of a filter channel. This means that the atmospheric transmission isn&#39;t smoothed at it&#39;s extrema. . The different atmospheric transmissions over just the bandwidth of the filters. . This in turn means that the $ mathrm{NEFD_{spec}}$ also approaches infinity at places where the atmospheric transmission approaches zero. . The different Noise Equivalent Flux Density for the spectral case. . Previous Chapter Next Chapter Bibliography .",
            "url": "https://joristiebosch.github.io/thesis/results",
            "relUrl": "/results",
            "date": " • Jan 3, 2022"
        }
        
    
  
    
        ,"post5": {
            "title": "Conclusion",
            "content": "In the previous chapters I have first explained photon bunching and photon statistics qualitatively and then explored its impact on the DESHIMA spectrometer quantitatively. I have shown a model for the probabilistics behind photon bunching, showing that it is not the detection itself that triggers bunching, but rather a change in the underlying photon probability. I have also discussed the coherence time, defined as the timescale below which the non-stochastic effects of photon bunching take hold. The coherence time is related to the bandwidth by . $$ begin{equation} tau_ mathrm{coh} approx frac{1}{ Delta nu} end{equation}$$After exploring photon statistics, I discussed photon noise induced by both Poisson statistics and photon bunching. The total noise equivalent power induced by photon noise is given by[1]: . $$ begin{equation} mathrm{NEP}_{ tau, mathrm{ph}}^2= frac{1}{ tau} int_0^ infty h nu eta left( nu right) mathrm{PSD} + eta^2 left( nu right) mathrm{PSD}^2d nu end{equation}$$ Whereas the approximation given by [1] and used previously in calculating the sensitivity of the DESHIMA system[2] is found by approximating a very narrow bandwidth ($ nu gg Delta nu$) and then approximating the integral by . $$ begin{equation} mathrm{NEP}_{ tau, mathrm{ph}}^2= frac{1}{ tau} left(h nu eta_0 mathrm{PSD} Delta nu+ eta_0^2 mathrm{PSD}^2 Delta nu right) label{NEP_int} end{equation}$$this approximation overestimates the photon bunching effects for a filter $ eta left( nu right)$ with a Lorentzian shape. I have shown that, in the case of a Lorentzian filter and a flat $ mathrm{PSD}$, eq. eqref{NEP_int} collapses to . $$ begin{equation} mathrm{NEP}_{ tau, mathrm{ph}}^2= frac{1}{ tau} left(h nu eta_0 mathrm{PSD} Delta nu+ frac{2}{ pi} eta_0^2 mathrm{PSD}^2 Delta nu right) end{equation}$$with $ Delta nu$ the $ mathrm{FWHM}$ of the filter. . Besides this algebraic result for a Lorentzian filter I have also modified the existing deshima-sensitivity[3] model to calculate the integral in eq. eqref{NEP_int} not just for mathematical filters, but for arbitrary filter shapes loaded in via a file. This allows researchers to compare the sensitivity of various designs in software. . To verify the changes to the model I have compared it with the old model and confirmed that the latter overestimated the bunching noise by a factor of $ pi/2$ , even for a non-flat $ mathrm{PSD}$. Other than this, the changes affect the power and noise in local extrema of the $ mathrm{PSD}$, where the old model didn&#39;t integrate over the full range of the filter and therefore took the $ mathrm{PSD}$ as a flat spectrum locally. . The future of this research . Because the model now more closely resembles the physics that is occurring inside the filter section of a DESHIMA spectrometer, it can be used to compare different filter designs in the deshima-sensitivity package itself. This is an important tool to compare filter topologies differing from Lorentzian shapes. Paired with methods to accurately describe the coupling of a source to the detector it can be used to very accurately calculate the signal to noise ratio of a specific filter profile, aiding in the experimental design of different filter profiles. Such research is in progress and as such the model will immediately be put to use. . The improved accuracy of the approximation in the bunching term for a Lorentzian filter can prove useful when designing the DESHIMA spectrometer, as it gives a more physically rigorous target of the maximum sensitivity the DESHIMA spectrometer can strive towards. . Finally, this thesis gives a thorough overview of photon statistics in astronomical measurement and of photon bunching in particular and as such can be a great teaching tool. My thesis supervisor, dr. Akira Endo, has been very interested in using this as teaching material for courses he gives on the subject and I am looking forward to helping other students understand photon statistics and photon bunching better. . Previous Chapter Appendix Bibliography . [1]J. Zmuidzinas, “Thermal noise and correlations in photon detection,” Applied Optics, vol. 42, no. 25, p. 4989, 2003, doi: 10.1364/ao.42.004989. | [2]A. Endo et al., “First light demonstration of the integrated superconducting spectrometer,” Nature Astronomy, vol. 3, no. 11, pp. 989–996, 2019, doi: 10.1038/s41550-019-0850-8. | [3]A. Endo and A. Taniguchi, “deshima-sensitivity v0.3.0,” pypi.org. Open Source, Jun-2021 [Online]. Available at: https://pypi.org/project/deshima-sensitivity/ | .",
            "url": "https://joristiebosch.github.io/thesis/conclusion",
            "relUrl": "/conclusion",
            "date": " • Jan 2, 2022"
        }
        
    
  
    
        ,"post6": {
            "title": "Technical information on how this blog is made",
            "content": "Introduction . This blog is written using fastpages[1], an easy-to-use (and to setup) way to convert Jupyter Notebooks to blogs, which are automatically hosted on a Github Pages website. This post serves as an introduction for potential users, as a way for me to test some things and as a reference for some more obscure parts of the Fastpages process. Let&#39;s begin! . Why Fastpages? . A big part of my thesis will be working in python, specifically in Jupyter Notebooks. These are great ways to blend python scripts with markdown and some $ LaTeX$ features, meaning that in one cell I can mathmatically derive some expression and in the next I can script it in Python. This back and forth got me thinking about using these notebooks as the foundation for my thesis, which led me to fastpages. This means that if I write proper jupyter notebooks, I will be able to: . Work on the problem at hand | Share the problem at hand in a more informal way | Copy-paste a section straight into my final report | . all from the same source file. Sounds great! . However, there are some limitations to vanilla fastpages . Pedantic Limitations and how to solve them . Equations . Using jupyter notebooks you can enter inline math, for example for variables like $x$ and $ eta_{NEP}$ by using the syntax $some expression$, just like you would do in $ LaTeX$ markdown files. However a centered function . $$ Complicated math $$ . will not be numbered and is not referenceable. Thankfully Anthoine C.[2] gave the solution, which is to override the default mathrenderer with a couple of lines of code and that seemed to do the trick. . $$ begin{equation} i hbar frac{ partial mathbf{ Psi}(x,t)}{ partial t}= left(- frac{ hbar}{2m} frac{ partial^2}{ partial x^2}+V(x,t) right) mathbf{ Psi}(x,t) end{equation}$$ and as we can see in eqref{Schrodinger}, we have a beatifully typeset, referenced Schrodinger Equation. However, as we can see from the Identity matrix in $ mathbb{R}^4$ eqref{I_R4}, the equation reference varies in size with the size of the equation, so maybe don&#39;t throw away your favorite $ LaTeX$ renderer yet. $$ begin{equation} I = begin{pmatrix}1&amp;0&amp;0&amp;0 0&amp;1&amp;0&amp;0 0&amp;0&amp;1&amp;0 0&amp;0&amp;0&amp;1 end{pmatrix} end{equation}$$ . BibTex . Fastpages has a built-in way to handle in-text references, but in order to minimize the manual work in copy-pasting sections of notebook to blog to thesis, I have decided to swap it out for a BibTex compliant renderer, as described by the fastpages team [3]. As you can see from this post, this works well. The big advantage is that the entire website uses a single references.bib file, so I can cite the same reference across multiple posts and end up with a single reference file when I want to consolidate multiple posts in a $ LaTeX$ thesis or a single post. . One caveat in in-text refencing is the usual [&lt;a class=&quot;latex_cit&quot; id=&quot;call-&lt;source&gt;&quot; href=&quot;#cit-&lt;source&gt;&quot;&gt;&lt;source&gt;&lt;/a&gt;] doesn&#39;t work and {% cite &lt;source&gt; %} is needed instead. This can be changed in bulk using the find and replace feature of any editor however. . Bibliography . [1]H. Husain and J. Howard, “Introducing fastpages,” fastpages. fast.ai, Feb-2020 [Online]. Available at: https://fastpages.fast.ai/fastpages/jupyter/2020/02/21/introducing-fastpages.html | [2]A. C., “Consider setting use_math to true by default,” fast.ai Forums. fast.ai, Apr-2020 [Online]. Available at: https://forums.fast.ai/t/consider-setting-use-math-to-true-by-default/64276/6 | [3]“Citations in Fastpages via BibTeX and jekyll-scholar,” fastpages. fast.ai, Jul-2020 [Online]. Available at: https://drscotthawley.github.io/devblog4/2020/07/01/Citations-Via-Bibtex.html | .",
            "url": "https://joristiebosch.github.io/thesis/technical",
            "relUrl": "/technical",
            "date": " • Oct 10, 2021"
        }
        
    
  

  
  

  
      ,"page1": {
          "title": "About Me",
          "content": "This website is powered by fastpages 1. . a blogging platform that natively supports Jupyter notebooks in addition to other formats. &#8617; . |",
          "url": "https://joristiebosch.github.io/thesis/about/",
          "relUrl": "/about/",
          "date": ""
      }
      
  

  

  
  

  

  
  

  
  

  
  

  
      ,"page8": {
          "title": "",
          "content": "Sitemap: {{ “sitemap.xml” | absolute_url }} | .",
          "url": "https://joristiebosch.github.io/thesis/robots.txt",
          "relUrl": "/robots.txt",
          "date": ""
      }
      
  

  
  

}